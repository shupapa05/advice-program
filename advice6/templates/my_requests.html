<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚´ ìƒë‹´ ë‚´ì—­</title>
  <style>
    body {
      font-family: 'Nanum Gothic', sans-serif;
      max-width: 980px;
      margin: 60px auto;
      padding: 20px;
      background-color: #f8f9fa;
    }
    h2 { text-align: center; margin-bottom: 18px; }
    .sub { text-align:center; color:#555; margin: -6px 0 18px; font-size:14px; }

    table { width: 100%; border-collapse: collapse; background-color: white; }
    th, td { padding: 12px; border: 1px solid #ddd; text-align: center; }
    th { background-color: #7ed6df; color: white; }
    tr:nth-child(even) { background-color: #f4f4f4; }
    td.txt-left { text-align: left; }

    .btn {
      display: inline-block; padding: 10px 18px; background-color: #7ed6df; color: white;
      border-radius: 8px; text-decoration: none; font-size: 14px; border: none; cursor: pointer;
    }
    .btn:hover { background-color: #22a6b3; }

    .btn-sm { padding: 6px 10px; font-size: 13px; border-radius: 6px; }
    .btn-danger { background:#ef4444; }
    .btn-danger:hover { background:#dc2626; }
    .btn-ghost { background:#fff; color:#111; border:1px solid #ccc; }
    .btn-ghost:hover { background:#f3f4f6; }

    .actions { display:flex; gap:6px; justify-content:center; align-items:center; flex-wrap:wrap; }
    .pwbar {
      display:flex; gap:8px; align-items:center; justify-content:center;
      margin: 0 0 12px; font-size:14px;
    }
    .pwbar input {
      padding:8px 10px; border:1px solid #ccc; border-radius:6px; width:200px; font:inherit;
    }

    .footer { text-align: center; margin-top: 24px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
  </style>
</head>
<body>
  <h2>ğŸ—‚ {{ name }}ë‹˜ì˜ ìƒë‹´ ì‹ ì²­ ë‚´ì—­</h2>
  <div class="sub">â€» ì‹ ì²­ ë‚´ìš©ì€ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆê³ , ì‚­ì œ ì‹œì—ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.</div>

  {% if data %}
    <!-- ê³µí†µ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥: ì‚­ì œ ë²„íŠ¼ ëˆŒë €ì„ ë•Œ ë¹„ì–´ ìˆìœ¼ë©´ ì—¬ê¸° ê°’ì´ ìë™ ì‚¬ìš©ë©ë‹ˆë‹¤. -->
    <div class="pwbar">
      <span>ğŸ›¡ ì‚­ì œ ë¹„ë°€ë²ˆí˜¸:</span>
      <input id="globalPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ í•œ ë²ˆë§Œ ì…ë ¥">
      <button class="btn btn-ghost btn-sm" type="button" onclick="document.getElementById('globalPw').value=''">ì§€ìš°ê¸°</button>
    </div>

    <table>
      <thead>
        <tr>
          <th style="width:130px">ì‹ ì²­ì¼</th>
          <th style="width:110px">ì£¼ì œ</th>
          <th>ë‚´ìš©</th>
          <th style="width:90px">ìƒíƒœ</th>
          <th style="width:90px">êµì‚¬ ë‹µë³€</th>
          <th style="width:140px">ë‚´ ì‹ ì²­ ê´€ë¦¬</th>
        </tr>
      </thead>
      <tbody>
        {% for item in data %}
        <tr>
          <td>{{ item.date }}</td>
          <td>{{ item.topic }}</td>
          <td class="txt-left">{{ item.content }}</td>
          <td>{{ item.status }}</td>
          <td>
            {% if item.answer %}
              <a class="btn btn-sm" href="/view_answer/{{ item.id }}" target="_blank">ğŸ” ë³´ê¸°</a>
            {% else %}-{% endif %}
          </td>
          <td>
            <div class="actions">
              <!-- ìˆ˜ì •: í¸ì§‘ í˜ì´ì§€ë¡œ ì´ë™(ê·¸ í˜ì´ì§€ì—ì„œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸) -->
              <a class="btn btn-sm" href="/student_request_edit/{{ item.id }}">âœï¸ ìˆ˜ì •</a>

              <!-- ì‚­ì œ: ë¹„ë°€ë²ˆí˜¸ í•„ìš”(ë¹ˆ ê²½ìš° ìœ„ì˜ ê³µí†µ ì…ë ¥ê°’ ìë™ ì‚¬ìš©) -->
              <form class="del-form" action="/student_request_delete/{{ item.id }}" method="post"
                    onsubmit="return handleDeleteSubmit(this)">
                <input type="password" name="password" placeholder="ë¹„ë²ˆ" style="padding:6px 8px;border:1px solid #ccc;border-radius:6px;width:90px">
                <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘ ì‚­ì œ</button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p style="text-align: center; margin-top: 40px;">ì¡°íšŒëœ ìƒë‹´ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endif %}

  <div class="footer">
    <a class="btn" href="/check_request">ğŸ”™ ìƒë‹´ ë‚´ì—­ ë‹¤ì‹œ ì¡°íšŒí•˜ê¸°</a>
    <a class="btn" href="/">ğŸ  ì²˜ìŒ í™”ë©´ìœ¼ë¡œ</a>
  </div>

  <script>
    // ì‚­ì œ í¼ ì œì¶œ ì‹œ: í–‰ì˜ passwordê°€ ë¹„ì–´ ìˆìœ¼ë©´ ìƒë‹¨ ê³µí†µ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©
    function handleDeleteSubmit(form){
      const rowPw = form.querySelector('input[name="password"]');
      if(!rowPw.value){
        const global = document.getElementById('globalPw').value.trim();
        if(!global){
          alert('ì‚­ì œí•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
          return false;
        }
        rowPw.value = global; // ê³µí†µ ë¹„ë²ˆ ë³µì‚¬
      }
      return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”? ì‚­ì œ í›„ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }
  </script>
</body>
</html>
