<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>상담 기록 {{ '수정' if log else '작성' }}</title>
  <style>
    body{font-family:'Nanum Gothic',sans-serif;max-width:900px;margin:60px auto;padding:20px;background:#f7f7fb}
    h2{text-align:center;margin-bottom:14px}
    .card{background:#fff;border:1px solid #e9ecef;border-radius:10px;padding:16px;margin-bottom:12px}
    .row{display:grid;grid-template-columns:120px 1fr;gap:8px;align-items:center;margin:6px 0}
    textarea{width:100%;min-height:160px;padding:10px;border:1px solid #ced4da;border-radius:8px;font:inherit}
    input[type="datetime-local"]{padding:6px 8px;border:1px solid #ced4da;border-radius:8px;font:inherit}
    .btn{display:inline-block;padding:10px 18px;border-radius:8px;text-decoration:none;border:none;cursor:pointer}
    .btn-primary{background:#22a6b3;color:#fff}
    .btn-outline{background:#fff;border:1px solid #adb5bd;color:#495057}
    .actions{display:flex;gap:8px;justify-content:center;margin-top:14px}
    .meta{color:#666}
  </style>
</head>
<body>
  <h2>📝 상담 기록 {{ '수정' if log else '작성' }}</h2>

  <div class="card">
    <div class="row"><div class="meta">신청자</div><div>{{ request_data.grade }}학년 {{ request_data.class_num }}반 {{ request_data.number }}번 {{ request_data.name }}</div></div>
    <div class="row"><div class="meta">주제</div><div>{{ request_data.topic }}</div></div>
    <div class="row" style="grid-template-columns:120px 1fr"><div class="meta">신청 내용</div><div style="white-space:pre-wrap">{{ request_data.content }}</div></div>
    {% if log %}<div class="row"><div class="meta">기존 작성</div><div class="meta">{{ log.date }}</div></div>{% endif %}
  </div>

  <form method="post" class="card">
    <input type="hidden" name="page" value="{{ back_page }}">
    <div class="row" style="grid-template-columns:120px 1fr"><div class="meta">상담 내용</div>
      <div><textarea name="memo" required>{{ log.memo if log else '' }}</textarea></div>
    </div>

    {% if show_dt_edit %}
    <div class="row"><div class="meta">기록 시각</div>
      <div>
        <label style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" name="apply_dt">
          <span>아래 시각으로 저장</span>
        </label>
        <div style="margin-top:6px">
          <input type="datetime-local" name="log_dt" value="{{ default_dt_input }}" step="60">
        </div>
      </div>
    </div>
    {% endif %}

    <div class="actions">
      <button type="submit" class="btn btn-primary">저장</button>
      <a class="btn btn-outline" href="{{ url_for('consult_list', page=back_page) }}">목록으로</a>
    </div>
  </form>
</body>
</html>
